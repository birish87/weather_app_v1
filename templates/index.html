<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>{{ app_name }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <script defer src="/static/icon-amcharts-map.js"></script>
    <script defer src="/static/app.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 16px; }
        .row { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; }
        input { padding: 8px; min-width: 280px; }
        button { padding: 8px 12px; cursor: pointer; }
        .card { border: 1px solid #ddd; border-radius: 8px; padding: 12px; margin-top: 12px; }
        .muted { color: #666; }
        .right { margin-left: auto; }
        dialog { border: 1px solid #ddd; border-radius: 10px; padding: 12px; max-width: 700px; }
        /* Small circular info button */
        .info-circle {
          width: 28px;
          height: 28px;
          border-radius: 50%;
          border: 1px solid #ccc;
          background: #fff;
          color: #555;
          font-size: 16px;
          font-weight: bold;
          line-height: 1;
          padding: 0;
          cursor: pointer;
          display: inline-flex;
          align-items: center;
          justify-content: center;
        }

        .info-circle:hover {
          background: #f5f5f5;
          border-color: #999;
        }
    </style>
</head>
<body>
<div class="row">
    <h2 style="margin:0;">{{ app_name }}</h2>
    <div class="right"></div>
    <span class="muted">Candidate: <strong>{{ candidate_name }}</strong></span>
    <button id="infoBtn">Info</button>
    <a href="/records" style="margin-left:8px;">Saved Records (CRUD)</a>
</div>

<div class="card">
    <h3 style="margin-top:0;">Search weather by location</h3>
    <!-- Simple form -> server-rendered /results page -->
    <form class="row" action="/results" method="get" style="align-items:center;">
        <input name="q" placeholder="City, ZIP, postal, or coordinates" required/>

        <button
                type="button"
                id="formatInfoBtn"
                class="info-circle"
                title="Accepted formats"
                aria-label="Accepted formats"
        >
            â„¹
        </button>

        <button type="submit">Get Weather</button>
    </form>


    <dialog id="formatInfoDialog">
        <h3>Accepted location formats</h3>
        <div class="muted">
            <p><b>US city/state:</b> <code>Newark, NJ US</code> (we assume US)</p>
            <p><b>US ZIP:</b> <code>10001</code> or <code>10001-1234</code> or <code>10001,US</code></p>
            <p><b>International city:</b> <code>Paris, FR</code> or <code>Berlin, DE</code></p>
            <p><b>International postal (recommended):</b> <code>10115, DE</code> or <code>SW1A 1AA, GB</code></p>
            <p><b>Postal + city (if postal alone fails):</b> <code>SW1A 1AA, London, GB</code></p>
            <p><b>Coordinates:</b> <code>40.7128,-74.0060</code></p>
        </div>
        <div class="row">
            <button type="button" id="closeFormatInfo">Close</button>
        </div>
    </dialog>


    <hr/>

    <h3>Use my current location</h3>
    <div class="row">
        <button id="geoBtn">Get Weather Near Me</button>
        <span class="muted" id="geoStatus"></span>
    </div>

    <!-- We render geolocation weather results dynamically -->
    <div id="geoResult" class="card" style="display:none;"></div>
</div>

<div class="card">
    <h3 style="margin-top:0;">Assessment 2 (CRUD): create a stored date-range query</h3>
    <div class="muted">
        Stores location + date range + returned daily temps into SQLite.
        (Daily temps are sourced from Open-Meteo; location validation comes from OpenWeather geocoding.)
    </div>

    <form id="createForm" class="row" onsubmit="return false;">
        <input id="loc" placeholder="Location (e.g., 'Chicago, IL')" required/>
        <input id="start" type="date" required/>
        <input id="end" type="date" required/>
        <button id="createBtn">Create Record</button>
        <span id="createStatus" class="muted"></span>
    </form>
</div>

<dialog id="infoDialog">
    <h3>About</h3>
    <p>
        This app was built for the PM Accelerator technical assessment.
        It demonstrates real-time weather retrieval, location handling, 5-day forecast,
        browser geolocation, and database persistence with CRUD + export.
    </p>
    <p class="muted">
        The Product Manager Accelerator Program is designed to support PM professionals through every stage of their
        careers. From students looking for entry-level jobs to Directors looking to take on a leadership role, our
        program has helped over hundreds of students fulfill their career aspirations.
        Our Product Manager Accelerator community are ambitious and committed. Through our program they have learnt,
        honed and developed new PM and leadership skills, giving them a strong foundation for their future endeavors.
    </p>
    <div class="row">
        <button id="closeInfo">Close</button>
    </div>
</dialog>
</body>
</html>
